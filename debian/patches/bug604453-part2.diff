From 48aad766111b69530e63f432023aa246737c381d Mon Sep 17 00:00:00 2001
From: Frank Ch. Eigler <fche@redhat.com>
Date: Thu, 18 Aug 2011 13:59:19 -0400
Subject: [PATCH 2/2] debian bug#604453: tweak new blacklist items to exploit regexps

---
 dwflpp.cxx |   19 ++++++-------------
 1 files changed, 6 insertions(+), 13 deletions(-)

Author: Frank Ch. Eigler <fche@redhat.com>
Applied-Upstream: http://sources.redhat.com/git/gitweb.cgi?p=systemtap.git;a=commit;h=48aad766111b69530e63f432023aa246737c381d
Bug-Debian: http://bugs.debian.org/604453

--- a/dwflpp.cxx
+++ b/dwflpp.cxx
@@ -2983,21 +2983,14 @@
   blfn += "|sync_regs";
   blfn += "|unhandled_fault";
   blfn += "|unknown_nmi_error";
-  blfn += "|xen_set_debugreg";
-  blfn += "|xen_get_debugreg";
-  blfn += "|xen_irq_enable_direct_reloc";
-  blfn += "|xen_irq_disable_direct";
-  blfn += "|xen_irq_disable_direct_end";
-  blfn += "|xen_save_fl_direct";
-  blfn += "|xen_restore_fl_direct_reloc";
+  blfn += "|xen_[gs]et_debugreg";
+  blfn += "|xen_irq_.*";
+  blfn += "|xen_.*_fl_direct.*";
   blfn += "|check_events";
   blfn += "|xen_adjust_exception_frame";
-  blfn += "|xen_iret";
-  blfn += "|xen_iret_reloc";
-  blfn += "|xen_sysret64";
-  blfn += "|xen_sysret64_reloc";
-  blfn += "|test_ti_thread_flag.clone.16";
-  blfn += "|hash_ptr.clone.12";
+  blfn += "|xen_iret.*";
+  blfn += "|xen_sysret64.*";
+  blfn += "|test_ti_thread_flag.*";
   blfn += "|inat_get_opcode_attribute";
   blfn += "|system_call_after_swapgs";
 
