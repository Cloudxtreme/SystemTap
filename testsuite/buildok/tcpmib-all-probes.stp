#! stap -p4

// Tests if all probes in the tcpmib tapset are resolvable.

probe tcpmib.* {}

// This function is just for test, the real one is
// in tcpipstat.stp
function tcpmib_filter_key:long (sk:long, op:long) {
       if (!sk) return 0
       return op
}

probe begin{
        print(tcpmib_get_state(0) +
              tcpmib_local_addr(0) +
              tcpmib_remote_addr(0) +
              tcpmib_local_port(0) +
              tcpmib_remote_port(0) +
              _rtn_local() +
              _is_reset(0) +
%( kernel_v < "2.6.31" %?
              __tcpmib_input_route_type_old(0)
%:
              __tcpmib_input_route_type_new(0)
%)
              )
}
